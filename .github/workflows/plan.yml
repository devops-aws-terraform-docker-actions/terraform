name: Terraform Plan

on:
  push:
    branches: [ '**' ]  # Triggered on push to any branch
    paths:
      - '*/**.tf'  # Any Terraform file in any subdirectory
      - '*/**.tfvars'  # Any Terraform state file in any subdirectory
      - '.github/workflows/plan.yml'
  pull_request:
    branches:
      - '**'
    paths:
      - '*/**.tf'  # Any Terraform file in any subdirectory
      - '*/**.tfvars'  # Any Terraform state file in any subdirectory
      - '.github/workflows/plan.yml'
    types: [opened, synchronize, reopened]

env:
  TF_VERSION: '1.5.7'  # Specify Terraform version
  AWS_REGION: 'ap-southeast-1'  # Update with your AWS region

jobs:
  check:
    name: fetch modified directories
    output: 
      changed_folders: ${{ steps.check.outputs.folders }}
      run_tf: ${{ steps.check.outputs.run_tf }}
    runs-on: ubuntu-latest